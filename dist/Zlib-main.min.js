"use strict";(()=>{var b={create(r,e,t){return this.update(r,0,e,t)},update(r,e,t=0,i){var s=b.Table,a=i??r.length;e^=4294967295;for(var h=a&7;h--;++t)e=e>>>8^s[(e^r[t])&255];for(var h=a>>3;h--;t+=8)e=e>>>8^s[(e^r[t])&255],e=e>>>8^s[(e^r[t+1])&255],e=e>>>8^s[(e^r[t+2])&255],e=e>>>8^s[(e^r[t+3])&255],e=e>>>8^s[(e^r[t+4])&255],e=e>>>8^s[(e^r[t+5])&255],e=e>>>8^s[(e^r[t+6])&255],e=e>>>8^s[(e^r[t+7])&255];return e^4294967295},single(r,e){return b.Table[(r^e)&255]^r>>>8},Table:new Uint32Array(256),init(){for(var r=0;r<256;++r){for(var e=r,t=0;t<8;++t)e=e&1?3988292384^e>>>1:e>>>1;this.Table[r]=e>>>0}}};b.init();var q=8,W=32768,ne=32768,K=32768,he=32768,k=32768,F=class S{constructor(e,t=0){if(this.bitindex=0,this.buffer=e instanceof Uint8Array?e:new Uint8Array(he),this.index=t,this.buffer.length*2<=this.index)throw new Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()}expandBuffer(){var e=this.buffer,t=new Uint8Array(e.length<<1);return t.set(e),this.buffer=t,t}rev32(e){return S.ReverseTable[e&255]<<24|S.ReverseTable[e>>>8&255]<<16|S.ReverseTable[e>>>16&255]<<8|S.ReverseTable[e>>>24&255]}writeBits(e,t,i=!1){var s=this.buffer,a=this.index,h=this.bitindex,f=s[a],n;if(i&&t>1&&(e=t>8?this.rev32(e)>>32-t:S.ReverseTable[e]>>8-t),t+h<8)f=f<<t|e,h+=t;else for(n=0;n<t;++n)f=f<<1|e>>t-n-1&1,++h===8&&(h=0,s[a++]=S.ReverseTable[f],f=0,a===s.length&&(s=this.expandBuffer()));s[a]=f,this.buffer=s,this.bitindex=h,this.index=a}finish(){var e=this.buffer,t=this.index,i;return this.bitindex>0&&(e[t]<<=8-this.bitindex,e[t]=S.ReverseTable[e[t]],t++),i=e.subarray(0,t),i}static init(){this.ReverseTable=new Uint8Array(256).map((e,t)=>{var i=t,s=7;for(t>>>=1;t;t>>>=1)i<<=1,i|=t&1,--s;return i<<s&255})}};F.init();var fe=class{constructor(r){this.buffer=new Uint16Array(r*2),this.length=0}getParent(r){return((r-2)/4|0)*2}getChild(r){return 2*r+2}push(r,e){var t,i,s=this.buffer,a;for(t=this.length,s[this.length++]=e,s[this.length++]=r;t>0&&(i=this.getParent(t),s[t]>s[i]);)a=s[t],s[t]=s[i],s[i]=a,a=s[t+1],s[t+1]=s[i+1],s[i+1]=a,t=i;return this.length}pop(){var r,e,t=this.buffer,i,s,a;for(e=t[0],r=t[1],this.length-=2,t[0]=t[this.length],t[1]=t[this.length+1],a=0;s=this.getChild(a),!(s>=this.length);){if(s+2<this.length&&t[s+2]>t[s]&&(s+=2),t[s]>t[a])i=t[a],t[a]=t[s],t[s]=i,i=t[a+1],t[a+1]=t[s+1],t[s+1]=i;else break;a=s}return{index:r,value:e,length:this.length}}};function E(r){var e=r.length,t,i,s,a,h,f,n=0,u=Number.POSITIVE_INFINITY;for(a=0;a<e;++a)r[a]>n&&(n=r[a]),r[a]<u&&(u=r[a]);var c=1<<n,v=new Uint32Array(c);for(t=1,i=0,s=2;t<=n;){for(a=0;a<e;++a)if(r[a]===t){var o=0,w=i;for(h=0;h<t;++h)o=o<<1|w&1,w>>=1;for(f=t<<16|a,h=o;h<c;h+=s)v[h]=f;++i}++t,i<<=1,s<<=1}return[v,n,u]}var G=258,Z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Y=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),H=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),V=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),O=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),X=function(){var r=new Uint8Array(288).map((e,t)=>t<=143?8:t<=255?9:t<=279?7:8);return E(r)}(),J=function(){var r=new Uint8Array(30).map(e=>5);return E(r)}(),N=class{constructor(r,e={}){this.buffer=null,this.block=[],this.blocks=[],this.bufferSize=K,this.totalpos=0,this.ip=0,this.op=0,this.bitsbuf=0,this.bitsbuflen=0,this.bfinal=!1,this.bufferType=1,this.resize=!1,this.currentLitlenTable=null,this.input=r instanceof Uint8Array?r:new Uint8Array(r),this.ip=e.index??0,this.bufferSize=e.bufferSize??K,this.bufferType=e.bufferType??1,this.resize=e.resize??!1,this.bufferType==0?(this.op=k,this.output=new Uint8Array(k+this.bufferSize+G)):(this.op=0,this.output=new Uint8Array(this.bufferSize))}decompress(){for(;!this.bfinal;)this.parseBlock();switch(this.bufferType){case 0:return this.concatBufferBlock();case 1:return this.concatBufferDynamic();default:throw new Error("invalid inflate mode")}}parseBlock(){var r=this.readBits(3);switch(r&1&&(this.bfinal=!0),r>>>=1,r){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+r)}}readBits(r){var e=this.bitsbuf,t=this.bitsbuflen,i=this.input,s=this.ip,a=i.length,h;if(s+(r-t+7>>3)>=a)throw new Error("input buffer is broken");for(;t<r;)e|=i[s++]<<t,t+=8;return h=e&(1<<r)-1,e>>>=r,t-=r,this.bitsbuf=e,this.bitsbuflen=t,this.ip=s,h}readCodeByTable(r){for(var e=this.bitsbuf,t=this.bitsbuflen,i=this.input,s=this.ip,a=i.length,h=r[0],f=r[1];t<f&&!(s>=a);)e|=i[s++]<<t,t+=8;var n=h[e&(1<<f)-1],u=n>>>16;if(u>t)throw new Error("invalid code length: "+u);return this.bitsbuf=e>>u,this.bitsbuflen=t-u,this.ip=s,n&65535}parseUncompressedBlock(){var r=this.input,e=this.ip,t=this.output,i=this.op,s=r.length,a=t.length;if(this.bitsbuf=0,this.bitsbuflen=0,e+1>=s)throw new Error("invalid uncompressed block header: LEN");var h=r[e++]|r[e++]<<8;if(e+1>=s)throw new Error("invalid uncompressed block header: NLEN");var f=r[e++]|r[e++]<<8;if(h===~f)throw new Error("invalid uncompressed block header: length verify");if(e+h>r.length)throw new Error("input buffer is broken");switch(this.bufferType){case 0:for(;i+h>t.length;){var n=a-i;h-=n,t.set(r.subarray(e,e+n),i),i+=n,e+=n,this.op=i,t=this.expandBufferBlock(),i=this.op}break;case 1:for(;i+h>t.length;)t=this.expandBufferAdaptive(0,2);break;default:throw new Error("invalid inflate mode")}t.set(r.subarray(e,e+h),i),i+=h,e+=h,this.ip=e,this.op=i,this.output=t}parseFixedHuffmanBlock(){switch(this.bufferType){case 1:this.decodeHuffmanAdaptive(X,J);break;case 0:this.decodeHuffmanBlock(X,J);break;default:throw new Error("invalid inflate mode")}}parseDynamicHuffmanBlock(){for(var r=this.readBits(5)+257,e=this.readBits(5)+1,t=this.readBits(4)+4,i=new Uint8Array(Z.length),s=0;s<t;++s)i[Z[s]]=this.readBits(3);for(var a=E(i),h=new Uint8Array(r+e),f=0,s=0;s<r+e;){var n=this.readCodeByTable(a);switch(n){case 16:for(var u=3+this.readBits(2);u--;)h[s++]=f;break;case 17:for(var u=3+this.readBits(3);u--;)h[s++]=0;f=0;break;case 18:for(var u=11+this.readBits(7);u--;)h[s++]=0;f=0;break;default:h[s++]=n,f=n;break}}var c=E(h.subarray(0,r)),v=E(h.subarray(r));switch(this.bufferType){case 1:this.decodeHuffmanAdaptive(c,v);break;case 0:this.decodeHuffmanBlock(c,v);break;default:throw new Error("invalid inflate mode")}}decodeHuffmanBlock(r,e){var t=this.output,i=this.op;this.currentLitlenTable=r;for(var s=t.length-G,a;(a=this.readCodeByTable(r))!==256;){if(a<256){i>=s&&(this.op=i,t=this.expandBufferBlock(),i=this.op),t[i++]=a;continue}var h=a-257,f=Y[h];H[h]>0&&(f+=this.readBits(H[h])),a=this.readCodeByTable(e);var n=V[a];for(O[a]>0&&(n+=this.readBits(O[a])),i>=s&&(this.op=i,t=this.expandBufferBlock(),i=this.op);f--;)t[i]=t[i++-n]}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=i}decodeHuffmanAdaptive(r,e){var t=this.output,i=this.op;this.currentLitlenTable=r;for(var s=t.length,a;(a=this.readCodeByTable(r))!==256;){if(a<256){i>=s&&(t=this.expandBufferAdaptive(),s=t.length),t[i++]=a;continue}var h=a-257,f=Y[h];H[h]>0&&(f+=this.readBits(H[h])),a=this.readCodeByTable(e);var n=V[a];for(O[a]>0&&(n+=this.readBits(O[a])),i+f>s&&(t=this.expandBufferAdaptive(),s=t.length);f--;)t[i]=t[i++-n]}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=i}expandBufferBlock(){var r=new Uint8Array(this.op-k),e=this.op-k,t=this.output;return r.set(t.subarray(k,r.length)),this.blocks.push(r),this.totalpos+=r.length,t.set(t.subarray(e,e+k)),this.op=k,t}expandBufferAdaptive(r=0,e){var t=Math.floor(this.input.length/this.ip+1),i,s=this.input,a=this.output;if(t=(e??t)+r,t<2){var h=(s.length-this.ip)/this.currentLitlenTable[2],f=Math.floor(h/2*258);i=f<a.length?a.length+f:a.length<<1}else i=a.length*t;var n=new Uint8Array(i);return n.set(a),this.output=n,this.output}concatBufferBlock(){var r=0,e=this.totalpos+(this.op-k),t=this.output,i=this.blocks,s=new Uint8Array(e),a,h;if(i.length===0)return this.output.subarray(k,this.op);for(var f=0;f<i.length;++f){var n=i[f];s.set(n,r),r+=n.length}for(var f=k;f<this.op;++f)s[r++]=t[f];return this.blocks=[],this.buffer=s,this.buffer}concatBufferDynamic(){var r=this.op,e;return this.resize?(e=new Uint8Array(r),e.set(this.output.subarray(0,r))):e=this.output.subarray(0,r),this.buffer=e,this.buffer}},D=3,Q=258,oe=32768,ue=16,ve=286,le=function(){var r=[],e;for(e=0;e<288;e++)switch(!0){case e<=143:r.push([e+48,8]);break;case e<=255:r.push([e-144+400,9]);break;case e<=279:r.push([e-256+0,7]);break;case e<=287:r.push([e-280+192,8]);break;default:throw"invalid literal: "+e}return r}(),ce=class ie{constructor(e,t){this.length=e,this.backwardDistance=t}static{this.LengthCodeTable=function(){var e=[],t,i;for(t=3;t<=258;t++)i=s(t),e[t]=i[2]<<24|i[1]<<16|i[0];function s(a){switch(!0){case a===3:return[257,a-3,0];case a===4:return[258,a-4,0];case a===5:return[259,a-5,0];case a===6:return[260,a-6,0];case a===7:return[261,a-7,0];case a===8:return[262,a-8,0];case a===9:return[263,a-9,0];case a===10:return[264,a-10,0];case a<=12:return[265,a-11,1];case a<=14:return[266,a-13,1];case a<=16:return[267,a-15,1];case a<=18:return[268,a-17,1];case a<=22:return[269,a-19,2];case a<=26:return[270,a-23,2];case a<=30:return[271,a-27,2];case a<=34:return[272,a-31,2];case a<=42:return[273,a-35,3];case a<=50:return[274,a-43,3];case a<=58:return[275,a-51,3];case a<=66:return[276,a-59,3];case a<=82:return[277,a-67,4];case a<=98:return[278,a-83,4];case a<=114:return[279,a-99,4];case a<=130:return[280,a-115,4];case a<=162:return[281,a-131,5];case a<=194:return[282,a-163,5];case a<=226:return[283,a-195,5];case a<=257:return[284,a-227,5];case a===258:return[285,a-258,0];default:throw"invalid length: "+a}}return new Uint32Array(e)}()}getDistanceCode(e){var t;switch(!0){case e===1:t=[0,e-1,0];break;case e===2:t=[1,e-2,0];break;case e===3:t=[2,e-3,0];break;case e===4:t=[3,e-4,0];break;case e<=6:t=[4,e-5,1];break;case e<=8:t=[5,e-7,1];break;case e<=12:t=[6,e-9,2];break;case e<=16:t=[7,e-13,2];break;case e<=24:t=[8,e-17,3];break;case e<=32:t=[9,e-25,3];break;case e<=48:t=[10,e-33,4];break;case e<=64:t=[11,e-49,4];break;case e<=96:t=[12,e-65,5];break;case e<=128:t=[13,e-97,5];break;case e<=192:t=[14,e-129,6];break;case e<=256:t=[15,e-193,6];break;case e<=384:t=[16,e-257,7];break;case e<=512:t=[17,e-385,7];break;case e<=768:t=[18,e-513,8];break;case e<=1024:t=[19,e-769,8];break;case e<=1536:t=[20,e-1025,9];break;case e<=2048:t=[21,e-1537,9];break;case e<=3072:t=[22,e-2049,10];break;case e<=4096:t=[23,e-3073,10];break;case e<=6144:t=[24,e-4097,11];break;case e<=8192:t=[25,e-6145,11];break;case e<=12288:t=[26,e-8193,12];break;case e<=16384:t=[27,e-12289,12];break;case e<=24576:t=[28,e-16385,13];break;case e<=32768:t=[29,e-24577,13];break;default:throw"invalid distance"}return t}toLZ77Array(){var e=ie.LengthCodeTable[this.length],t=this.getDistanceCode(this.backwardDistance);return[e&65535,e>>>16&255,e>>>24,t[0],t[1],t[2]]}},R=class{constructor(r,e={}){this.freqsLitLen=null,this.freqsDist=null,this.op=0,this.input=r instanceof Uint8Array?r:new Uint8Array(r),this.lazy=e.lazy??0,this.compressionType=e.compressionType??2,e.outputBuffer?this.output=e.outputBuffer instanceof Uint8Array?e.outputBuffer:new Uint8Array(e.outputBuffer):this.output=new Uint8Array(ne),this.op=e.outputIndex??0}compress(){var r=this.input,e=r.length;switch(this.compressionType){case 0:for(var t=0,e=r.length;t<e;){var i=r.subarray(t,t+65535);t+=i.length,this.makeNocompressBlock(i,t===e)}break;case 1:this.output=this.makeFixedHuffmanBlock(r,!0),this.op=this.output.length;break;case 2:this.output=this.makeDynamicHuffmanBlock(r,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output}makeNocompressBlock(r,e){var t=this.output,i=this.op;for(t=new Uint8Array(this.output.buffer);t.length<=i+r.length+5;)t=new Uint8Array(t.length<<1);t.set(this.output);var s=0;t[i++]=(e?1:0)|s<<1;var a=r.length,h=~a+65536&65535;return t[i++]=a&255,t[i++]=a>>>8&255,t[i++]=h&255,t[i++]=h>>>8&255,t.set(r,i),i+=r.length,t=t.subarray(0,i),this.op=i,this.output=t,t}makeFixedHuffmanBlock(r,e){var t=new F(new Uint8Array(this.output.buffer),this.op);t.writeBits(e?1:0,1,!0),t.writeBits(1,2,!0);var i=this.LZ77(r);return this.fixedHuffman(i,t),t.finish()}makeDynamicHuffmanBlock(r,e){var t=new F(new Uint8Array(this.output.buffer),this.op);t.writeBits(e?1:0,1,!0),t.writeBits(2,2,!0);var i=this.LZ77(r),s=this.getLengths(this.freqsLitLen,15),a=this.getCodesFromLengths(s),h=this.getLengths(this.freqsDist,7),f=this.getCodesFromLengths(h),n,u;for(n=286;n>257&&s[n-1]===0;n--);for(u=30;u>1&&h[u-1]===0;u--);var c=this.getTreeSymbols(n,s,u,h),v=this.getLengths(c.freqs,7),o=new Array(19);for(l=0;l<19;l++)o[l]=v[Z[l]];for(var w=19;w>4&&o[w-1]===0;w--);var p=this.getCodesFromLengths(v);for(t.writeBits(n-257,5,!0),t.writeBits(u-1,5,!0),t.writeBits(w-4,4,!0),l=0;l<w;l++)t.writeBits(o[l],3,!0);for(var l=0;l<c.codes.length;l++){var m=c.codes[l],d;if(t.writeBits(p[m],v[m],!0),m>=16){switch(l++,m){case 16:d=2;break;case 17:d=3;break;case 18:d=7;break;default:throw"invalid code: "+m}t.writeBits(c.codes[l],d,!0)}}return this.dynamicHuffman(i,[a,s],[f,h],t),t.finish()}dynamicHuffman(r,e,t,i){for(var s=e[0],a=e[1],h=t[0],f=t[1],n=0;n<r.length;++n){var u=r[n],c;if(i.writeBits(s[u],a[u],!0),u>256)i.writeBits(r[++n],r[++n],!0),c=r[++n],i.writeBits(h[c],f[c],!0),i.writeBits(r[++n],r[++n],!0);else if(u===256)break}return i}fixedHuffman(r,e){for(var t=0;t<r.length;t++){var i=r[t];if(F.prototype.writeBits.apply(e,le[i]),i>256)e.writeBits(r[++t],r[++t],!0),e.writeBits(r[++t],5),e.writeBits(r[++t],r[++t],!0);else if(i===256)break}return e}LZ77(r){var e={},t=null,i=new Uint16Array(r.length*2),s=0,a=0,h=new Uint32Array(30),f=this.lazy,n,u=new Uint32Array(286);u[256]=1;function c(A,M){for(var g=A.toLZ77Array(),L=0;L<g.length;++L)i[s++]=g[L];u[g[0]]++,h[g[3]]++,a=A.length+M-1,t=null}var v,o=r.length;for(v=0;v<o;++v){for(var w=0,p=0;p<D&&v+p!==o;++p)w=w<<8|r[v+p];e[w]===void 0&&(e[w]=[]);var l=e[w];if(a-- >0){l.push(v);continue}for(;l.length>0&&v-l[0]>oe;)l.shift();if(v+D>=o){t&&c(t,-1);for(var p=0,m=o-v;p<m;++p)n=r[v+p],i[s++]=n,++u[n];break}if(l.length>0){var d=this.searchLongestMatch(r,v,l);t?t.length<d.length?(n=r[v-1],i[s++]=n,++u[n],c(d,0)):c(t,-1):d.length<f?t=d:c(d,0)}else t?c(t,-1):(n=r[v],i[s++]=n,++u[n]);l.push(v)}return i[s++]=256,u[256]++,this.freqsLitLen=u,this.freqsDist=h,i.subarray(0,s)}searchLongestMatch(r,e,t){var i,s=0,a=r.length;e:for(var h=0;h<t.length;h++){var f=t[t.length-h-1],n=D;if(s>D){for(var u=s;u>D;u--)if(r[f+u-1]!==r[e+u-1])continue e;n=s}for(;n<Q&&e+n<a&&r[f+n]===r[e+n];)++n;if(n>s&&(i=f,s=n),n===Q)break}return new ce(s,e-i)}getTreeSymbols(r,e,t,i){var s=new Uint32Array(r+t),a,h,f=r+t,n=new Uint32Array(316),u=new Uint8Array(19);for(h=0,a=0;a<r;a++)s[h++]=e[a];for(a=0;a<t;a++)s[h++]=i[a];var c=0;for(a=0,f=s.length;a<f;a+=h){for(h=1;a+h<f&&s[a+h]===s[a];++h);var v=h;if(s[a]===0)if(v<3)for(;v-- >0;)n[c++]=0,u[0]++;else for(;v>0;){var o=v<138?v:138;o>v-3&&o<v&&(o=v-3),o<=10?(n[c++]=17,n[c++]=o-3,u[17]++):(n[c++]=18,n[c++]=o-11,u[18]++),v-=o}else if(n[c++]=s[a],u[s[a]]++,v--,v<3)for(;v-- >0;)n[c++]=s[a],u[s[a]]++;else for(;v>0;){var o=v<6?v:6;o>v-3&&o<v&&(o=v-3),n[c++]=16,n[c++]=o-3,u[16]++,v-=o}}return{codes:n.subarray(0,c),freqs:u}}getLengths(r,e){for(var t=r.length,i=new fe(2*ve),s=new Uint8Array(t),a=0;a<t;++a)r[a]>0&&i.push(a,r[a]);var h=new Array(i.length/2),f=new Uint32Array(i.length/2);if(h.length===1)return s[i.pop().index]=1,s;for(var n=i.length/2,a=0;a<n;++a)h[a]=i.pop(),f[a]=h[a].value;var u=this.reversePackageMerge(f,f.length,e);for(a=0;a<h.length;++a)s[h[a].index]=u[a];return s}reversePackageMerge(r,e,t){var i=new Uint16Array(t),s=new Uint8Array(t),a=new Uint8Array(e),h=new Array(t),f=new Array(t),n=new Array(t);function u(d){var A=f[d][n[d]];A===e?(u(d+1),u(d+1)):--a[A],++n[d]}i[t-1]=e;for(var c=(1<<t)-e,v=1<<t-1,o=0;o<t;++o)c<v?s[o]=0:(s[o]=1,c-=v),c<<=1,i[t-2-o]=(i[t-1-o]/2|0)+e;i[0]=s[0],h[0]=new Array(i[0]),f[0]=new Array(i[0]);for(var o=1;o<t;++o)i[o]>2*i[o-1]+s[o]&&(i[o]=2*i[o-1]+s[o]),h[o]=new Array(i[o]),f[o]=new Array(i[o]);for(var w=0;w<e;++w)a[w]=t;for(var p=0;p<i[t-1];++p)h[t-1][p]=r[p],f[t-1][p]=p;for(var w=0;w<t;++w)n[w]=0;s[t-1]===1&&(--a[0],++n[t-1]);for(var o=t-2;o>=0;--o){for(var w=0,l=0,m=n[o+1],p=0;p<i[o];p++)l=h[o+1][m]+h[o+1][m+1],l>r[w]?(h[o][p]=l,f[o][p]=e,m+=2):(h[o][p]=r[w],f[o][p]=w,++w);n[o]=0,s[o]===1&&u(o)}return a}getCodesFromLengths(r){for(var e=new Uint16Array(r.length),t=[],i=[],s=0,a,h,f,n=0;n<r.length;n++)t[r[n]]=(t[r[n]]|0)+1;for(var n=1;n<=ue;n++)i[n]=s,s+=t[n]|0,s<<=1;for(var n=0;n<r.length;n++)for(s=i[r[n]],i[r[n]]+=1,e[n]=0,h=0,f=r[n];h<f;h++)e[n]=e[n]<<1|s&1,s>>>=1;return e}};function T(r){for(var e=new Uint8Array(r.length),t=0;t<e.length;t++)e[t]=r[t].charCodeAt(0)&255;return e}var y=class{constructor(r,e=0){this.buffer=r,this.p=e,this.length=r.length}get pointer(){return this.p}set pointer(r){this.p=r}get offset(){return this.p}set offset(r){this.p=r}readByte(){return this.buffer[this.p++]}writeByte(r){this.buffer[this.p++]=r}readShort(){return this.buffer[this.p++]|this.buffer[this.p++]<<8}writeShort(r){this.buffer[this.p++]=r&255,this.buffer[this.p++]=r>>>8&255}readUint(){return(this.buffer[this.p++]|this.buffer[this.p++]<<8|this.buffer[this.p++]<<16|this.buffer[this.p++]<<24)>>>0}writeUint(r){this.buffer[this.p++]=r&255,this.buffer[this.p++]=r>>>8&255,this.buffer[this.p++]=r>>>16&255,this.buffer[this.p++]=r>>>24&255}readUintBE(){return(this.buffer[this.p++]<<24|this.buffer[this.p++]<<16|this.buffer[this.p++]<<8|this.buffer[this.p++])>>>0}writeUintBE(r){this.buffer[this.p++]=r>>>24&255,this.buffer[this.p++]=r>>>16&255,this.buffer[this.p++]=r>>>8&255,this.buffer[this.p++]=r&255}readArray(r){return this.buffer.subarray(this.p,this.p+=r)}writeArray(r){this.buffer.set(r,this.p),this.p+=r.length}readString(r){return new TextDecoder().decode(this.readArray(r))}writeString(r){this.writeArray(new TextEncoder().encode(r))}readAscii(r){var e="",t=this.readArray(r);return t.forEach(i=>{e+=String.fromCharCode(i)}),e}writeAscii(r){this.writeArray(T(r))}},I=new Uint8Array([31,139]),pe=class{constructor(r,e={}){this.ip=0,this.output=null,this.op=0,this.filename="",this.comment="",this.input=r,this.flags={},e.filename&&(this.filename=e.filename,this.flags.fname=!0),e.comment&&(this.comment=e.comment??"",this.flags.fcomment=!0),e.hcrc&&(this.flags.fhcrc=!0),this.deflateOptions=e.deflateOptions??{}}compress(){var r=new Uint8Array(W),o=new y(r,0),e=this.input,t=this.ip,i=this.filename,s=this.comment;o.writeArray(I),o.writeByte(8);var a=0;this.flags.fname&&(a|=8),this.flags.fcomment&&(a|=16),this.flags.fhcrc&&(a|=2),o.writeByte(a);var h=Math.floor(Date.now()/1e3);if(o.writeUint(h),o.writeByte(0),o.writeByte(3),this.flags.fname){for(var f=0;f<i.length;++f){var n=i.charCodeAt(f);n>255?o.writeShort(n):o.writeByte(n)}o.writeByte(0)}if(this.flags.fcomment){for(var f=0;f<s.length;++f){var n=s.charCodeAt(f);n>255?o.writeShort(n):o.writeByte(n)}o.writeByte(0)}if(this.flags.fhcrc){var u=b.create(r,0,o.p)&65535;o.writeShort(u)}this.deflateOptions.outputBuffer=r,this.deflateOptions.outputIndex=o.p;var c=new R(e,this.deflateOptions);r=c.compress();var v=c.op;v+8>r.length&&(this.output=new Uint8Array(v+8),this.output.set(new Uint8Array(r.buffer)),r=this.output);var o=new y(r,v),w=b.create(e);o.writeUint(w);var p=e.length;return o.writeUint(p),this.ip=t,v<r.length&&(this.output=r=r.subarray(0,v)),r}},we=class{constructor(r){this.ip=0,this.member=[],this.decompressed=!1,this.input=r}getMembers(){return this.decompressed||this.decompress(),this.member.slice()}decompress(){for(var r=this.input.length;this.ip<r;)this.decodeMember();return this.decompressed=!0,this.concatMember()}decodeMember(){var r={},e=this.input,t=new y(e,this.ip);if(r.id1=t.readByte(),r.id2=t.readByte(),r.id1!==I[0]||r.id2!==I[2])throw new Error("invalid file signature:"+r.id1+","+r.id2);if(r.cm=t.readByte(),r.cm!=8)throw new Error("unknown compression method: "+r.cm);var i=t.readByte();r.flg=i;var s=t.readUint();if(r.mtime=new Date(s*1e3),r.xfl=t.readByte(),r.os=t.readByte(),(i&4)>0&&(r.xlen=t.readShort(),t.p=this.decodeSubField(t.p,r.xlen)),(i&8)>0){for(var a="",h=1;h!=0&&(h=t.readByte(),h!=0);)a+=String.fromCharCode(h);r.name=a}if((i&16)>0){for(var a="",h=1;h!=0&&(h=t.readByte(),h!=0);)a+=String.fromCharCode(h);r.comment=a}if((i&2)>0&&(r.crc16=b.create(e,0,t.p)&65535,r.crc16!==t.readShort()))throw new Error("invalid header crc16");var o=t.readUint(),f=void 0;e.length-t.p-4-4<o*512&&(f=o);var n=new N(e,{index:t.p,bufferSize:f}),u=n.decompress();r.data=u;var c=n.ip;t=new y(e,c);var v=t.readUint();if(b.create(u)!==v)throw new Error("invalid CRC-32 checksum: 0x"+b.create(u).toString(16)+" / 0x"+v.toString(16));var o=t.readUint();if((u.length&4294967295)!==o)throw new Error("invalid input size: "+(u.length&4294967295)+" / "+o);this.member.push(r),this.ip=c}decodeSubField(r,e){return r+e}concatMember(){for(var r=this.member,e=0,t=0;t<r.length;++t)e+=r[t].data.length;for(var i=0,s=new Uint8Array(e),t=0;t<r.length;++t)s.set(r[t].data,i),i+=r[t].data.length;return s}},x={getByte(r){var e=r[2]&65535|2;return e*(e^1)>>8&255},updateKeys(r,e){r[0]=b.single(r[0],e),r[1]=(((r[1]+(r[0]&255))*20173>>>0)*6681>>>0)+1>>>0,r[2]=b.single(r[2],r[1]>>>24)},createKey(r){typeof r=="string"&&(r=T(r));for(var e=new Uint32Array([305419896,591751049,878082192]),t=0;t<r.length;++t)this.updateKeys(e,r[t]&255);return e},decode(r,e){return e^=this.getByte(r),this.updateKeys(r,e),e},encode(r,e){var t=this.getByte(r);return this.updateKeys(r,e),t^e}},C=new Uint8Array([80,75,1,2]),z=new Uint8Array([80,75,3,4]),U=new Uint8Array([80,75,5,6]),de=class{constructor(r=[]){this.files=[],this.password=null,this.comment=r instanceof Uint8Array?r:new Uint8Array(r)}addFile(r,e="",t={}){var i=r.length;r=r instanceof Uint8Array?r:new Uint8Array(r);var s=t.compressionMethod??8,a=0,h=!1;t.compress!=!1&&s==8&&(a=b.create(r),r=this.deflateWithOption(r,t),h=!0),this.files.push({filename:e,buffer:r,compressionMethod:s,option:t,compressed:h,encrypted:!1,size:i,crc32:a})}setPassword(r){this.password=r}compress(){for(var r=this.files,e=0,t=0,i=0;i<r.length;++i){var s=r[i],a=s.filename.length,h=s.option.extraField?s.option.extraField.length:0,f=s.option.comment?s.option.comment.length:0;if(s.compressed||(s.crc32=b.create(s.buffer),s.compressionMethod==8&&(s.buffer=this.deflateWithOption(s.buffer,s.option),s.compressed=!0)),s.option.password!=null||this.password!=null){var n=x.createKey(s.option.password??this.password),u=s.buffer,c=new Uint8Array(u.length+12);c.set(u,12),u=c;var v=0;for(v=0;v<12;++v)u[v]=x.encode(n,i===11?s.crc32&255:Math.random()*256|0);for(;v<u.length;++v)u[v]=x.encode(n,u[v]);s.buffer=u}e+=30+a+s.buffer.length,t+=46+a+f}var o=22+(this.comment?this.comment.length:0),w=new Uint8Array(e+t+o),p=new y(w,0),l=new y(w,e);for(i=0;i<r.length;++i){var s=r[i],a=s.filename.length,h=0,f=s.option.comment?s.option.comment.length:0,m=p.p;p.writeArray(z),l.writeArray(C);var d=20;l.writeByte(d&255),l.writeByte(s.option.os??0),p.writeShort(d),l.writeShort(d);var A=0;(s.option.password!=null||this.password!=null)&&(A|=1),p.writeShort(A),l.writeShort(A);var M=s.compressionMethod;p.writeShort(M),l.writeShort(M);var g=s.option.date??new Date,L=new Uint8Array([(g.getMinutes()&7)<<5|g.getSeconds()>>>1,g.getHours()<<3|g.getMinutes()>>3,(g.getMonth()+1&7)<<5|g.getDate(),(g.getFullYear()-1980&127)<<1|g.getMonth()+1>>3]);p.writeArray(L),l.writeArray(L);var _=s.crc32;p.writeUint(_),l.writeUint(_);var j=s.buffer.length;p.writeUint(j),l.writeUint(j);var ee=s.size;p.writeUint(ee),l.writeUint(ee),p.writeShort(a),l.writeShort(a),p.writeShort(h),l.writeShort(h),l.writeShort(f),l.writeByte(0),l.writeByte(0),l.writeByte(0),l.writeByte(0),l.writeByte(0),l.writeByte(0),l.writeByte(0),l.writeByte(0),l.writeUint(m);var re=s.filename;if(re){var te=T(re);p.writeArray(te),l.writeArray(te)}var P=s.option.extraField;P&&(p.writeArray(P),l.writeArray(P));var ae=s.option.comment;if(ae){var Se=T(ae);l.writeArray(Se)}p.writeArray(s.buffer)}var B=new y(w,e+t);return B.writeArray(U),B.writeByte(0),B.writeByte(0),B.writeByte(0),B.writeByte(0),B.writeShort(r.length),B.writeShort(r.length),B.writeUint(t),B.writeUint(e),f=this.comment?this.comment.length:0,B.writeShort(f),this.comment&&B.writeArray(this.comment),w}deflateWithOption(r,e){var t=new R(r,e.deflateOptions);return t.compress()}};function be(r){var e={};if(e.offset=r.p,r.readByte()!=z[0]||r.readByte()!=z[1]||r.readByte()!=z[2]||r.readByte()!=z[3])throw new Error("invalid local file header signature");return e.needVersion=r.readShort(),e.flags=r.readShort(),e.compression=r.readShort(),e.time=r.readShort(),e.date=r.readShort(),e.crc32=r.readUint(),e.compressedSize=r.readUint(),e.plainSize=r.readUint(),e.fileNameLength=r.readShort(),e.extraFieldLength=r.readShort(),e.filename=r.readString(e.fileNameLength),e.extraField=r.readArray(e.extraFieldLength),e.length=r.p-e.offset,e}function ye(r){var e={};if(e.offset=r.p,r.readByte()!=C[0]||r.readByte()!=C[1]||r.readByte()!=C[2]||r.readByte()!=C[3])throw new Error("invalid file header signature");return e.version=r.readByte(),e.os=r.readByte(),e.needVersion=r.readShort(),e.flags=r.readShort(),e.compression=r.readShort(),e.time=r.readShort(),e.date=r.readShort(),e.crc32=r.readUint(),e.compressedSize=r.readUint(),e.plainSize=r.readUint(),e.fileNameLength=r.readShort(),e.extraFieldLength=r.readShort(),e.fileCommentLength=r.readShort(),e.diskNumberStart=r.readShort(),e.internalFileAttributes=r.readShort(),e.externalFileAttributes=r.readUint(),e.relativeOffset=r.readUint(),e.filename=r.readString(e.fileNameLength),e.extraField=r.readArray(e.extraFieldLength),e.comment=r.readArray(e.fileCommentLength),e.length=r.p-e.offset,e}function me(r){for(var e=r.length-12;e>0;--e)if(r[e]===U[0]&&r[e+1]===U[1]&&r[e+2]===U[2]&&r[e+3]===U[3])return e;throw new Error("End of Central Directory Record not found")}function ge(r){var e={};const t=me(r),i=new y(r,t);if(i.readByte()!==U[0]||i.readByte()!==U[1]||i.readByte()!==U[2]||i.readByte()!==U[3])throw new Error("invalid signature");return e.numberOfThisDisk=i.readShort(),e.startDisk=i.readShort(),e.totalEntriesThisDisk=i.readShort(),e.totalEntries=i.readShort(),e.centralDirectorySize=i.readUint(),e.centralDirectoryOffset=i.readUint(),e.commentLength=i.readShort(),e.comment=i.readArray(e.commentLength),e}var Be=class{constructor(r,e){this.ip=0,this.EOCD=null,this.input=r instanceof Uint8Array?r:new Uint8Array(r),this.verify=e.verify??!1,e.password&&(this.password=typeof e.password=="string"?T(e.password):e.password instanceof Uint8Array?e.password:new Uint8Array(e.password))}parseFileHeader(){var r=[],e={};if(!this.fileHeaderList){for(var t=ge(this.input),i=new y(this.input,t.centralDirectoryOffset),s=0;s<t.totalEntries;++s){var a=ye(i);r[s]=a,e[a.filename]=s}if(t.centralDirectorySize<i.p-t.centralDirectoryOffset)throw new Error("invalid file header size");this.EOCD=t,this.fileHeaderList=r,this.filenameToIndex=e}}getFileData(r,e={}){var t=this.input,i=this.fileHeaderList,s;if(i||this.parseFileHeader(),i[r]==null)throw new Error("wrong index");var a=i[r].relativeOffset,h=new y(this.input,a),f=be(h);a+=f.length;var n=f.compressedSize;if(f.flags&1){var u=e.password??this.password;if(!u)throw new Error("encrypted: please set password");for(var c=x.createKey(u),v=a;v<a+12;++v)x.decode(c,t[v]);a+=12,n-=12;for(var v=a;v<a+n;++v)t[v]=x.decode(c,t[v])}if(f.compression==8?s=new N(this.input,{index:a,bufferSize:f.plainSize}).decompress():s=this.input.subarray(a,a+n),this.verify){var o=b.create(s);if(f.crc32!==o)throw new Error("Incorrect crc: file=0x"+f.crc32.toString(16)+", data=0x"+o.toString(16))}return s}getFilenames(){var r=[];this.fileHeaderList||this.parseFileHeader();for(var e=this.fileHeaderList,t=0;t<e.length;++t)r[t]=e[t].filename;return r}decompress(r,e={}){this.filenameToIndex||this.parseFileHeader();var t=this.filenameToIndex[r];if(t==null)throw new Error(r+" not found");return this.getFileData(t,e)}setPassword(r){typeof r=="string"?this.password=T(r):this.password=r instanceof Uint8Array?r:new Uint8Array(r)}},$={create(r){return typeof r=="string"&&(r=T(r)),this.update(1,r)},update(r,e){for(var t=r&65535,i=r>>16&65535,s=e.length,a=0;s>0;){var h=s>this.OptimizationParameter?this.OptimizationParameter:s;s-=h;do t+=e[a++],i+=t;while(--h);t%=65521,i%=65521}return(i<<16|t)>>>0},OptimizationParameter:1024},ke=class se{constructor(e,t={}){this.input=e,this.output=new Uint8Array(W);var i={};this.compressionType=t.compressionType??2,Object.assign(i,t),i.outputBuffer=this.output,this.rawDeflate=new R(this.input,i)}static compress(e,t){return new se(e,t).compress()}compress(){var e=this.output,t=new y(e,0),i=7,s=i<<4|q;t.writeByte(s);var a=0,h=this.compressionType,f=h<<6|a<<5,n=31-((s<<8)+f)%31;f|=n,t.writeByte(f);var u=$.create(this.input);this.rawDeflate.op=t.p,e=this.rawDeflate.compress();var c=e.length;return e=new Uint8Array(e.buffer),e.length<=c+4&&(this.output=new Uint8Array(e.length+4),this.output.set(e),e=this.output),e=e.subarray(0,c+4),t=new y(e,c),t.writeUintBE(u),e}},Ue=class{constructor(r,e={}){this.ip=0,this.input=r,this.ip=e.index??0,this.verify=e.verify??!1;var t=r[this.ip++],i=r[this.ip++];if((t&15)!=q)throw new Error("unsupported compression method");if(((t<<8)+i)%31!==0)throw new Error("invalid fcheck flag:"+((t<<8)+i)%31);if(i&32)throw new Error("fdict flag is not supported");this.rawinflate=new N(r,{index:this.ip,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})}decompress(){var r=this.input,e;e=this.rawinflate.decompress(),this.ip=this.rawinflate.ip;var t=new y(e,this.ip);if(this.verify){var i=t.readUintBE();if(i!==$.create(e))throw new Error("invalid adler-32 checksum")}return e}},Ae={GZip:pe,GUnzip:we,Zip:de,Unzip:Be,Deflate:ke,Inflate:Ue};window.Zlib=Ae})();
