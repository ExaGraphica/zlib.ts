"use strict";(()=>{function S(e){for(var r=new Uint8Array(e.length),t=0;t<r.length;t++)r[t]=e[t].charCodeAt(0)&255;return r}var B=class{constructor(e,r=0){this.buffer=e,this.p=r,this.length=e.length}get pointer(){return this.p}set pointer(e){this.p=e}get offset(){return this.p}set offset(e){this.p=e}truncateBuffer(e){return this.buffer=this.buffer.subarray(0,e),this.length=e,this.buffer}expandLength(e){const r=new Uint8Array(e);return r.set(this.buffer),this.buffer=r,this.length=e,this.buffer}setLength(e){e>this.length?this.expandLength(e):this.truncateBuffer(e)}restoreBuffer(){this.buffer=new Uint8Array(this.buffer.buffer)}readByte(){return this.buffer[this.p++]}writeByte(e){this.buffer[this.p++]=e}readShort(){return this.buffer[this.p++]|this.buffer[this.p++]<<8}writeShort(e){this.buffer[this.p++]=e&255,this.buffer[this.p++]=e>>>8&255}readUint(){return(this.buffer[this.p++]|this.buffer[this.p++]<<8|this.buffer[this.p++]<<16|this.buffer[this.p++]<<24)>>>0}writeUint(e){this.buffer[this.p++]=e&255,this.buffer[this.p++]=e>>>8&255,this.buffer[this.p++]=e>>>16&255,this.buffer[this.p++]=e>>>24&255}readUintBE(){return(this.buffer[this.p++]<<24|this.buffer[this.p++]<<16|this.buffer[this.p++]<<8|this.buffer[this.p++])>>>0}writeUintBE(e){this.buffer[this.p++]=e>>>24&255,this.buffer[this.p++]=e>>>16&255,this.buffer[this.p++]=e>>>8&255,this.buffer[this.p++]=e&255}readArray(e){return this.buffer.subarray(this.p,this.p+=e)}writeArray(e){this.buffer.set(e,this.p),this.p+=e.length}readString(e){return new TextDecoder().decode(this.readArray(e))}writeString(e){this.writeArray(new TextEncoder().encode(e))}readAscii(e){var r="",t=this.readArray(e);return t.forEach(a=>{r+=String.fromCharCode(a)}),r}writeAscii(e){this.writeArray(S(e))}},A={create(e,r,t){return this.update(e,0,r,t)},update(e,r,t=0,a){var i=A.Table,s=a??e.length;r^=4294967295;for(var h=s&7;h--;++t)r=r>>>8^i[(r^e[t])&255];for(var h=s>>3;h--;t+=8)r=r>>>8^i[(r^e[t])&255],r=r>>>8^i[(r^e[t+1])&255],r=r>>>8^i[(r^e[t+2])&255],r=r>>>8^i[(r^e[t+3])&255],r=r>>>8^i[(r^e[t+4])&255],r=r>>>8^i[(r^e[t+5])&255],r=r>>>8^i[(r^e[t+6])&255],r=r>>>8^i[(r^e[t+7])&255];return(r^4294967295)>>>0},single(e,r){return A.Table[(e^r)&255]^r>>>8},Table:new Uint32Array(256),init(){for(var e=0;e<256;++e){for(var r=e,t=0;t<8;++t)r=r&1?3988292384^r>>>1:r>>>1;this.Table[e]=r>>>0}}};A.init();var j=32768,R=32768,ee=32768,k=32768,F=class m{constructor(r,t=0){if(this.bitindex=0,this.buffer=r instanceof Uint8Array?r:new Uint8Array(ee),this.index=t,this.buffer.length*2<=this.index)throw new Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()}expandBuffer(){var r=this.buffer,t=new Uint8Array(r.length<<1);return t.set(r),this.buffer=t,t}rev32(r){return m.ReverseTable[r&255]<<24|m.ReverseTable[r>>>8&255]<<16|m.ReverseTable[r>>>16&255]<<8|m.ReverseTable[r>>>24&255]}writeBits(r,t,a=!1){var i=this.buffer,s=this.index,h=this.bitindex,n=i[s],f;if(a&&t>1&&(r=t>8?this.rev32(r)>>32-t:m.ReverseTable[r]>>8-t),t+h<8)n=n<<t|r,h+=t;else for(f=0;f<t;++f)n=n<<1|r>>t-f-1&1,++h===8&&(h=0,i[s++]=m.ReverseTable[n],n=0,s===i.length&&(i=this.expandBuffer()));i[s]=n,this.buffer=i,this.bitindex=h,this.index=s}finish(){var r=this.buffer,t=this.index,a;return this.bitindex>0&&(r[t]<<=8-this.bitindex,r[t]=m.ReverseTable[r[t]],t++),a=r.subarray(0,t),a}static init(){this.ReverseTable=new Uint8Array(256).map((r,t)=>{var a=t,i=7;for(t>>>=1;t;t>>>=1)a<<=1,a|=t&1,--i;return a<<i&255})}};F.init();var re=class{constructor(e){this.length=0,this.nodes=0,this.buffer=new Uint16Array(e*2)}getParent(e){return e-2>>2<<1}getChild(e){return 2*e+2}push(e,r){var t,a,i=this.buffer,s;for(t=this.length,i[this.length++]=r,i[this.length++]=e,this.nodes++;t>0&&(a=this.getParent(t),i[t]>i[a]);)s=i[t],i[t]=i[a],i[a]=s,s=i[t+1],i[t+1]=i[a+1],i[a+1]=s,t=a;return this.length}pop(){var e=this.buffer,r,t=e[0],a=e[1];this.nodes--,this.length-=2,e[0]=e[this.length],e[1]=e[this.length+1];for(var i=0;;){var s=this.getChild(i);if(s>=this.length)break;if(s+2<this.length&&e[s+2]>e[s]&&(s+=2),e[s]>e[i])r=e[i],e[i]=e[s],e[s]=r,r=e[i+1],e[i+1]=e[s+1],e[s+1]=r;else break;i=s}return{index:a,value:t,length:this.length}}};function T(e){var r=e.length,t,a,i,s,h,n,f=0,u=Number.POSITIVE_INFINITY;for(s=0;s<r;++s)e[s]>f&&(f=e[s]),e[s]<u&&(u=e[s]);var l=1<<f,v=new Uint32Array(l);for(t=1,a=0,i=2;t<=f;){for(s=0;s<r;++s)if(e[s]===t){var o=0,w=a;for(h=0;h<t;++h)o=o<<1|w&1,w>>=1;for(n=t<<16|s,h=o;h<l;h+=i)v[h]=n;++a}++t,a<<=1,i<<=1}return[v,f,u]}var I=258,H=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),P=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),z=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),q=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),C=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Z=function(){var e=new Uint8Array(288).map((r,t)=>t<=143?8:t<=255?9:t<=279?7:8);return T(e)}(),W=function(){var e=new Uint8Array(30).map(r=>5);return T(e)}(),te=class{constructor(e,r={}){this.buffer=null,this.block=[],this.blocks=[],this.bufferSize=R,this.totalpos=0,this.ip=0,this.op=0,this.bitsbuf=0,this.bitsbuflen=0,this.bfinal=!1,this.bufferType=1,this.resize=!1,this.currentLitlenTable=null,this.input=e instanceof Uint8Array?e:new Uint8Array(e),this.ip=r.index??0,this.bufferSize=r.bufferSize??R,this.bufferType=r.bufferType??1,this.resize=r.resize??!1,this.bufferType==0?(this.op=k,this.output=new Uint8Array(k+this.bufferSize+I)):(this.op=0,this.output=new Uint8Array(this.bufferSize))}decompress(){for(;!this.bfinal;)this.parseBlock();switch(this.bufferType){case 0:return this.concatBufferBlock();case 1:return this.concatBufferDynamic();default:throw new Error("invalid inflate mode")}}parseBlock(){var e=this.readBits(3);switch(e&1&&(this.bfinal=!0),e>>>=1,e){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+e)}}readBits(e){var r=this.bitsbuf,t=this.bitsbuflen,a=this.input,i=this.ip,s=a.length,h;if(i+(e-t+7>>3)>=s)throw new Error("input buffer is broken");for(;t<e;)r|=a[i++]<<t,t+=8;return h=r&(1<<e)-1,r>>>=e,t-=e,this.bitsbuf=r,this.bitsbuflen=t,this.ip=i,h}readCodeByTable(e){for(var r=this.bitsbuf,t=this.bitsbuflen,a=this.input,i=this.ip,s=a.length,h=e[0],n=e[1];t<n&&!(i>=s);)r|=a[i++]<<t,t+=8;var f=h[r&(1<<n)-1],u=f>>>16;if(u>t)throw new Error("invalid code length: "+u);return this.bitsbuf=r>>u,this.bitsbuflen=t-u,this.ip=i,f&65535}parseUncompressedBlock(){var e=this.input,r=this.ip,t=this.output,a=this.op,i=e.length,s=t.length;if(this.bitsbuf=0,this.bitsbuflen=0,r+1>=i)throw new Error("invalid uncompressed block header: LEN");var h=e[r++]|e[r++]<<8;if(r+1>=i)throw new Error("invalid uncompressed block header: NLEN");var n=e[r++]|e[r++]<<8;if(h===~n)throw new Error("invalid uncompressed block header: length verify");if(r+h>e.length)throw new Error("input buffer is broken");switch(this.bufferType){case 0:for(;a+h>t.length;){var f=s-a;h-=f,t.set(e.subarray(r,r+f),a),a+=f,r+=f,this.op=a,t=this.expandBufferBlock(),a=this.op}break;case 1:for(;a+h>t.length;)t=this.expandBufferAdaptive(0,2);break;default:throw new Error("invalid inflate mode")}t.set(e.subarray(r,r+h),a),a+=h,r+=h,this.ip=r,this.op=a,this.output=t}parseFixedHuffmanBlock(){switch(this.bufferType){case 1:this.decodeHuffmanAdaptive(Z,W);break;case 0:this.decodeHuffmanBlock(Z,W);break;default:throw new Error("invalid inflate mode")}}parseDynamicHuffmanBlock(){for(var e=this.readBits(5)+257,r=this.readBits(5)+1,t=this.readBits(4)+4,a=new Uint8Array(H.length),i=0;i<t;++i)a[H[i]]=this.readBits(3);for(var s=T(a),h=new Uint8Array(e+r),n=0,i=0;i<e+r;){var f=this.readCodeByTable(s);switch(f){case 16:for(var u=3+this.readBits(2);u--;)h[i++]=n;break;case 17:for(var u=3+this.readBits(3);u--;)h[i++]=0;n=0;break;case 18:for(var u=11+this.readBits(7);u--;)h[i++]=0;n=0;break;default:h[i++]=f,n=f;break}}var l=T(h.subarray(0,e)),v=T(h.subarray(e));switch(this.bufferType){case 1:this.decodeHuffmanAdaptive(l,v);break;case 0:this.decodeHuffmanBlock(l,v);break;default:throw new Error("invalid inflate mode")}}decodeHuffmanBlock(e,r){var t=this.output,a=this.op;this.currentLitlenTable=e;for(var i=t.length-I,s;(s=this.readCodeByTable(e))!==256;){if(s<256){a>=i&&(this.op=a,t=this.expandBufferBlock(),a=this.op),t[a++]=s;continue}var h=s-257,n=P[h];z[h]>0&&(n+=this.readBits(z[h])),s=this.readCodeByTable(r);var f=q[s];for(C[s]>0&&(f+=this.readBits(C[s])),a>=i&&(this.op=a,t=this.expandBufferBlock(),a=this.op);n--;)t[a]=t[a++-f]}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=a}decodeHuffmanAdaptive(e,r){var t=this.output,a=this.op;this.currentLitlenTable=e;for(var i=t.length,s;(s=this.readCodeByTable(e))!==256;){if(s<256){a>=i&&(t=this.expandBufferAdaptive(),i=t.length),t[a++]=s;continue}var h=s-257,n=P[h];z[h]>0&&(n+=this.readBits(z[h])),s=this.readCodeByTable(r);var f=q[s];for(C[s]>0&&(f+=this.readBits(C[s])),a+n>i&&(t=this.expandBufferAdaptive(),i=t.length);n--;)t[a]=t[a++-f]}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=a}expandBufferBlock(){var e=new Uint8Array(this.op-k),r=this.op-k,t=this.output;return e.set(t.subarray(k,e.length)),this.blocks.push(e),this.totalpos+=e.length,t.set(t.subarray(r,r+k)),this.op=k,t}expandBufferAdaptive(e=0,r){var t=Math.floor(this.input.length/this.ip+1),a,i=this.input,s=this.output;if(t=(r??t)+e,t<2){var h=(i.length-this.ip)/this.currentLitlenTable[2],n=Math.floor(h*129);a=n<s.length?s.length+n:s.length<<1}else a=s.length*t;var f=new Uint8Array(a);return f.set(s),this.output=f,this.output}concatBufferBlock(){var e=0,r=this.totalpos+(this.op-k),t=this.output,a=this.blocks,i=new Uint8Array(r),s,h;if(a.length===0)return this.output.subarray(k,this.op);for(var n=0;n<a.length;++n){var f=a[n];i.set(f,e),e+=f.length}for(var n=k;n<this.op;++n)i[e++]=t[n];return this.blocks=[],this.buffer=i,this.buffer}concatBufferDynamic(){var e=this.op,r;return this.resize?(r=new Uint8Array(e),r.set(this.output.subarray(0,e))):r=this.output.subarray(0,e),this.buffer=r,this.buffer}},x=3,K=258,ae=32768,ie={getLengthCode(e){switch(!0){case e===3:return[257,e-3,0];case e===4:return[258,e-4,0];case e===5:return[259,e-5,0];case e===6:return[260,e-6,0];case e===7:return[261,e-7,0];case e===8:return[262,e-8,0];case e===9:return[263,e-9,0];case e===10:return[264,e-10,0];case e<=12:return[265,e-11,1];case e<=14:return[266,e-13,1];case e<=16:return[267,e-15,1];case e<=18:return[268,e-17,1];case e<=22:return[269,e-19,2];case e<=26:return[270,e-23,2];case e<=30:return[271,e-27,2];case e<=34:return[272,e-31,2];case e<=42:return[273,e-35,3];case e<=50:return[274,e-43,3];case e<=58:return[275,e-51,3];case e<=66:return[276,e-59,3];case e<=82:return[277,e-67,4];case e<=98:return[278,e-83,4];case e<=114:return[279,e-99,4];case e<=130:return[280,e-115,4];case e<=162:return[281,e-131,5];case e<=194:return[282,e-163,5];case e<=226:return[283,e-195,5];case e<=257:return[284,e-227,5];case e===258:return[285,e-258,0];default:throw"invalid length: "+e}},getDistanceCode(e){switch(!0){case e===1:return[0,e-1,0];case e===2:return[1,e-2,0];case e===3:return[2,e-3,0];case e===4:return[3,e-4,0];case e<=6:return[4,e-5,1];case e<=8:return[5,e-7,1];case e<=12:return[6,e-9,2];case e<=16:return[7,e-13,2];case e<=24:return[8,e-17,3];case e<=32:return[9,e-25,3];case e<=48:return[10,e-33,4];case e<=64:return[11,e-49,4];case e<=96:return[12,e-65,5];case e<=128:return[13,e-97,5];case e<=192:return[14,e-129,6];case e<=256:return[15,e-193,6];case e<=384:return[16,e-257,7];case e<=512:return[17,e-385,7];case e<=768:return[18,e-513,8];case e<=1024:return[19,e-769,8];case e<=1536:return[20,e-1025,9];case e<=2048:return[21,e-1537,9];case e<=3072:return[22,e-2049,10];case e<=4096:return[23,e-3073,10];case e<=6144:return[24,e-4097,11];case e<=8192:return[25,e-6145,11];case e<=12288:return[26,e-8193,12];case e<=16384:return[27,e-12289,12];case e<=24576:return[28,e-16385,13];case e<=32768:return[29,e-24577,13];default:throw"invalid distance"}},create(e){return this.getLengthCode(e.len).concat(this.getDistanceCode(e.backwardDistance))}},Y=class{constructor(e,r){this.table={},this.pos=0,this.prevMatch=null,this.skipLength=0,this.lazy=0,this.input=e,this.output=new Uint16Array(e.length*2),this.lazy=r,this.freqsLitLen=new Uint32Array(286),this.freqsLitLen[256]=1,this.freqsDist=new Uint32Array(30)}writeNum(e){this.output[this.pos++]=e}writeMatch(e,r){for(var t=ie.create(e),a=0;a<t.length;a++)this.writeNum(t[a]);this.freqsLitLen[t[0]]++,this.freqsDist[t[3]]++,this.skipLength=e.len+r-1,this.prevMatch=null}maxMatchTest(e,r,t){for(var a=t;a>x;a--)if(this.input[e+a-1]!==this.input[r+a-1])return!1;return!0}searchLongestMatch(e,r){for(var t=r[r.length],a=0,i=this.input.length,s=0;s<r.length;s++){var h=r[r.length-s-1],n=x;if(a>x){var f=a;if(!this.maxMatchTest(h,e,a))continue;n=a}for(;n<K&&e+n<i&&this.input[h+n]==this.input[e+n];)n++;if(n>a&&(t=h,a=n),n==K)break}return{len:a,backwardDistance:e-t}}encode(){var e={},r,t=this.input.length;for(r=0;r<t;++r){for(var a=0,i=0;i<x&&r+i!==t;i++)a=a<<8|this.input[r+i];e[a]===void 0&&(e[a]=[]);var s=e[a];if(this.skipLength-- >0){s.push(r);continue}for(;s.length>0&&r-s[0]>ae;)s.shift();if(r+x>=t){this.prevMatch&&this.writeMatch(this.prevMatch,-1);for(var i=r;i<t;i++){var h=this.input[i];this.writeNum(h),this.freqsLitLen[h]++}break}if(s.length>0){var n=this.searchLongestMatch(r,s);this.prevMatch?this.prevMatch.len<n.len?(h=this.input[r-1],this.writeNum(h),this.freqsLitLen[h]++,this.writeMatch(n,0)):this.writeMatch(this.prevMatch,-1):n.len<this.lazy?this.prevMatch=n:this.writeMatch(n,0)}else if(this.prevMatch)this.writeMatch(this.prevMatch,-1);else{var h=this.input[r];this.writeNum(h),this.freqsLitLen[h]++}s.push(r)}return this.writeNum(256),this.freqsLitLen[256]++,this.output=this.output.subarray(0,this.pos),this.output}},se=16,ne=286,he=function(){var e=[],r;for(r=0;r<288;r++)switch(!0){case r<=143:e.push([r+48,8]);break;case r<=255:e.push([r-144+400,9]);break;case r<=279:e.push([r-256+0,7]);break;case r<=287:e.push([r-280+192,8]);break;default:throw"invalid literal: "+r}return e}(),fe=class{constructor(e,r={}){this.op=0,this.input=e instanceof Uint8Array?e:new Uint8Array(e),this.lazy=r.lazy??0,this.compressionType=r.compressionType??2,r.outputBuffer?this.output=r.outputBuffer instanceof Uint8Array?r.outputBuffer:new Uint8Array(r.outputBuffer):this.output=new Uint8Array(j),this.op=r.outputIndex??0}compress(){var e=this.input,r=e.length;switch(this.compressionType){case 0:for(var t=0,r=e.length;t<r;){var a=e.subarray(t,t+65535);t+=a.length,this.makeNocompressBlock(a,t===r)}break;case 1:this.output=this.makeFixedHuffmanBlock(e,!0),this.op=this.output.length;break;case 2:this.output=this.makeDynamicHuffmanBlock(e,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output}makeNocompressBlock(e,r){var t=this.output;t=new Uint8Array(this.output.buffer);for(var a=new B(t,this.op),s=t.length;s<=this.op+e.length+5;)s=s<<1;a.expandLength(s);var i=0;a.writeByte((r?1:0)|i<<1);var s=e.length,h=s^65535;return a.writeShort(s),a.writeShort(h),a.writeArray(e),a.truncateBuffer(a.p),this.output=a.buffer,this.op=a.p,t}makeFixedHuffmanBlock(e,r){var t=new F(new Uint8Array(this.output.buffer),this.op);t.writeBits(r?1:0,1,!0),t.writeBits(1,2,!0);var a=new Y(e,this.lazy);return a.encode(),this.fixedHuffman(a,t),t.finish()}makeDynamicHuffmanBlock(e,r){var t=new F(new Uint8Array(this.output.buffer),this.op);t.writeBits(r?1:0,1,!0),t.writeBits(2,2,!0);var a=new Y(e,this.lazy),i=a.encode(),s=this.getLengths(a.freqsLitLen,15),h=this.getCodesFromLengths(s),n=this.getLengths(a.freqsDist,7),f=this.getCodesFromLengths(n),u,l;for(u=286;u>257&&s[u-1]===0;u--);for(l=30;l>1&&n[l-1]===0;l--);var v=this.getTreeSymbols(u,s,l,n),o=this.getLengths(v.freqs,7),w=new Array(19);for(d=0;d<19;d++)w[d]=o[H[d]];for(var b=19;b>4&&w[b-1]===0;b--);var U=this.getCodesFromLengths(o);for(t.writeBits(u-257,5,!0),t.writeBits(l-1,5,!0),t.writeBits(b-4,4,!0),d=0;d<b;d++)t.writeBits(w[d],3,!0);for(var d=0;d<v.codes.length;d++){var c=v.codes[d],p;if(t.writeBits(U[c],o[c],!0),c>=16){switch(d++,c){case 16:p=2;break;case 17:p=3;break;case 18:p=7;break;default:throw"invalid code: "+c}t.writeBits(v.codes[d],p,!0)}}return this.dynamicHuffman(i,[h,s],[f,n],t),t.finish()}dynamicHuffman(e,r,t,a){for(var i=r[0],s=r[1],h=t[0],n=t[1],f=0;f<e.length;++f){var u=e[f],l;if(a.writeBits(i[u],s[u],!0),u>256)a.writeBits(e[++f],e[++f],!0),l=e[++f],a.writeBits(h[l],n[l],!0),a.writeBits(e[++f],e[++f],!0);else if(u===256)break}return a}fixedHuffman(e,r){for(var t=e.output,a=0;a<t.length;a++){var i=t[a],s=he[i];if(r.writeBits(s[0],s[1]),i>256)r.writeBits(t[++a],t[++a],!0),r.writeBits(t[++a],5),r.writeBits(t[++a],t[++a],!0);else if(i===256)break}return r}getTreeSymbols(e,r,t,a){var i=new Uint32Array(e+t),s,h,n=e+t,f=new Uint32Array(316),u=new Uint8Array(19);for(h=0,s=0;s<e;s++)i[h++]=r[s];for(s=0;s<t;s++)i[h++]=a[s];var l=0;for(s=0,n=i.length;s<n;s+=h){for(h=1;s+h<n&&i[s+h]===i[s];++h);var v=h;if(i[s]===0)if(v<3)for(;v-- >0;)f[l++]=0,u[0]++;else for(;v>0;){var o=v<138?v:138;o>v-3&&o<v&&(o=v-3),o<=10?(f[l++]=17,f[l++]=o-3,u[17]++):(f[l++]=18,f[l++]=o-11,u[18]++),v-=o}else if(f[l++]=i[s],u[i[s]]++,v--,v<3)for(;v-- >0;)f[l++]=i[s],u[i[s]]++;else for(;v>0;){var o=v<6?v:6;o>v-3&&o<v&&(o=v-3),f[l++]=16,f[l++]=o-3,u[16]++,v-=o}}return{codes:f.subarray(0,l),freqs:u}}getLengths(e,r){for(var t=e.length,a=new re(2*ne),i=new Uint8Array(t),s=0;s<t;++s)e[s]>0&&a.push(s,e[s]);var h=new Array(a.nodes),n=new Uint32Array(a.nodes);if(h.length===1)return i[a.pop().index]=1,i;for(var f=a.nodes,s=0;s<f;++s)h[s]=a.pop(),n[s]=h[s].value;var u=this.reversePackageMerge(n,n.length,r);for(s=0;s<h.length;++s)i[h[s].index]=u[s];return i}reversePackageMerge(e,r,t){var a=new Uint16Array(t),i=new Array(t),s=new Uint8Array(r).fill(t),h=new Array(t),n=new Array(t),f=new Array(t).fill(0);function u(c){var p=n[c][f[c]];p===r?(u(c+1),u(c+1)):s[p]--,f[c]++}a[t-1]=r;for(var l=(1<<t)-r,v=1<<t-1,o=0;o<t;++o)l<v?i[o]=!1:(i[o]=!0,l-=v),l<<=1,a[t-2-o]=(a[t-1-o]>>>1)+r;a[0]=Number(i[0]),h[0]=new Array(a[0]),n[0]=new Array(a[0]);for(var o=1;o<t;++o)a[o]>2*a[o-1]+Number(i[o])&&(a[o]=2*a[o-1]+Number(i[o])),h[o]=new Array(a[o]),n[o]=new Array(a[o]);for(var w=0;w<a[t-1];++w)h[t-1][w]=e[w],n[t-1][w]=w;i[t-1]&&(s[0]--,f[t-1]++);for(var o=t-2;o>=0;o--){for(var b=0,U=f[o+1],w=0;w<a[o];w++){var d=h[o+1][U]+h[o+1][U+1];d>e[b]?(h[o][w]=d,n[o][w]=r,U+=2):(h[o][w]=e[b],n[o][w]=b,b++)}f[o]=0,i[o]&&u(o)}return s}getCodesFromLengths(e){for(var r=new Uint16Array(e.length),t=[],a=[],i=0,s,h,n=0;n<e.length;n++)t[e[n]]=(t[e[n]]??0)+1;for(var n=1;n<=se;n++)a[n]=i,i+=t[n]??0,i<<=1;for(var n=0;n<e.length;n++)for(i=a[e[n]],a[e[n]]+=1,r[n]=0,s=0;s<e[n];s++)r[n]=r[n]<<1|i&1,i>>>=1;return r}},L={getByte(e){var r=e[2]&65535|2;return r*(r^1)>>8&255},updateKeys(e,r){e[0]=A.single(r,e[0]),e[1]=e[1]+(e[0]&255),e[1]=Number(Math.imul(e[1],134775813)+1&4294967295),e[2]=A.single(e[1]>>>24,e[2])},createKey(e){typeof e=="string"&&(e=S(e));for(var r=new Uint32Array([305419896,591751049,878082192]),t=0;t<e.length;++t)this.updateKeys(r,e[t]&255);return r},decode(e,r){return r^=this.getByte(e),this.updateKeys(e,r),r},encode(e,r){var t=this.getByte(e);return this.updateKeys(e,r),t^r}},D=new Uint8Array([80,75,1,2]),E=new Uint8Array([80,75,3,4]),g=new Uint8Array([80,75,5,6]),oe=class{constructor(e=[]){this.files=[],this.password=null,this.comment=e instanceof Uint8Array?e:new Uint8Array(e)}addFile(e,r="",t={}){var a=e.length;e=e instanceof Uint8Array?e:new Uint8Array(e);var i=t.compressionMethod??8,s=0,h=!1;t.compress!=!1&&i==8&&(s=A.create(e),e=this.deflateWithOption(e,t),h=!0),this.files.push({filename:r,buffer:e,compressionMethod:i,option:t,compressed:h,encrypted:!1,size:a,crc32:s})}setPassword(e){this.password=e}compress(){for(var e=this.files,r=0,t=0,a=0;a<e.length;++a){var i=e[a],s=i.filename.length,h=i.option.extraField?i.option.extraField.length:0,n=i.option.comment?i.option.comment.length:0,f=i.option.date??new Date;if(i.option.mtime=new Uint8Array([(f.getMinutes()&7)<<5|f.getSeconds()>>>1,f.getHours()<<3|f.getMinutes()>>3,(f.getMonth()+1&7)<<5|f.getDate(),(f.getFullYear()-1980&127)<<1|f.getMonth()+1>>3]),i.compressed||(i.crc32=A.create(i.buffer),i.compressionMethod==8&&(i.buffer=this.deflateWithOption(i.buffer,i.option),i.compressed=!0)),i.option.password!=null||this.password!=null){var u=L.createKey(i.option.password??this.password);console.log(u);var l=i.buffer,v=new Uint8Array(l.length+12);v.set(l,12),l=v;for(var o=new B(l,0),w=0;w<12;++w){var b=l[w];w==10&&(b=i.crc32>>>8&255),w==11&&(b=i.crc32>>>0&255),l[w]=L.encode(u,b),console.log(b)}for(;w<l.length;++w)l[w]=L.encode(u,l[w]);i.buffer=l}r+=30+s+i.buffer.length,t+=46+s+n}var U=22+(this.comment?this.comment.length:0),d=new Uint8Array(r+t+U),c=new B(d,0),p=new B(d,r);for(a=0;a<e.length;++a){var i=e[a],s=i.filename.length,h=0,n=i.option.comment?i.option.comment.length:0,de=c.p;c.writeArray(E),p.writeArray(D);var M=20;p.writeByte(M&255),p.writeByte(i.option.os??0),c.writeShort(M),p.writeShort(M);var N=0;(i.option.password!=null||this.password!=null)&&(N|=1),c.writeShort(N),p.writeShort(N);var V=i.compressionMethod;c.writeShort(V),p.writeShort(V),c.writeArray(i.option.mtime),p.writeArray(i.option.mtime);var X=i.crc32;c.writeUint(X),p.writeUint(X);var G=i.buffer.length;c.writeUint(G),p.writeUint(G);var J=i.size;c.writeUint(J),p.writeUint(J),c.writeShort(s),p.writeShort(s),c.writeShort(h),p.writeShort(h),p.writeShort(n),p.writeByte(0),p.writeByte(0),p.writeByte(0),p.writeByte(0),p.writeByte(0),p.writeByte(0),p.writeByte(0),p.writeByte(0),p.writeUint(de);var Q=i.filename;if(Q){var $=S(Q);c.writeArray($),p.writeArray($)}var O=i.option.extraField;O&&(c.writeArray(O),p.writeArray(O));var _=i.option.comment;if(_){var be=S(_);p.writeArray(be)}c.writeArray(i.buffer)}var y=new B(d,r+t);return y.writeArray(g),y.writeByte(0),y.writeByte(0),y.writeByte(0),y.writeByte(0),y.writeShort(e.length),y.writeShort(e.length),y.writeUint(t),y.writeUint(r),n=this.comment?this.comment.length:0,y.writeShort(n),this.comment&&y.writeArray(this.comment),d}deflateWithOption(e,r){var t=new fe(e,r.deflateOptions);return t.compress()}};function ue(e){var r={};if(r.offset=e.p,e.readByte()!=E[0]||e.readByte()!=E[1]||e.readByte()!=E[2]||e.readByte()!=E[3])throw new Error("invalid local file header signature");return r.needVersion=e.readShort(),r.flags=e.readShort(),r.compression=e.readShort(),r.time=e.readShort(),r.date=e.readShort(),r.crc32=e.readUint(),r.compressedSize=e.readUint(),r.plainSize=e.readUint(),r.fileNameLength=e.readShort(),r.extraFieldLength=e.readShort(),r.filename=e.readString(r.fileNameLength),r.extraField=e.readArray(r.extraFieldLength),r.length=e.p-r.offset,r}function ve(e){var r={};if(r.offset=e.p,e.readByte()!=D[0]||e.readByte()!=D[1]||e.readByte()!=D[2]||e.readByte()!=D[3])throw new Error("invalid file header signature");return r.version=e.readByte(),r.os=e.readByte(),r.needVersion=e.readShort(),r.flags=e.readShort(),r.compression=e.readShort(),r.time=e.readShort(),r.date=e.readShort(),r.crc32=e.readUint(),r.compressedSize=e.readUint(),r.plainSize=e.readUint(),r.fileNameLength=e.readShort(),r.extraFieldLength=e.readShort(),r.fileCommentLength=e.readShort(),r.diskNumberStart=e.readShort(),r.internalFileAttributes=e.readShort(),r.externalFileAttributes=e.readUint(),r.relativeOffset=e.readUint(),r.filename=e.readString(r.fileNameLength),r.extraField=e.readArray(r.extraFieldLength),r.comment=e.readArray(r.fileCommentLength),r.length=e.p-r.offset,r}function le(e){for(var r=e.length-12;r>0;--r)if(e[r]===g[0]&&e[r+1]===g[1]&&e[r+2]===g[2]&&e[r+3]===g[3])return r;throw new Error("End of Central Directory Record not found")}function pe(e){var r={};const t=le(e),a=new B(e,t);if(a.readByte()!==g[0]||a.readByte()!==g[1]||a.readByte()!==g[2]||a.readByte()!==g[3])throw new Error("invalid signature");return r.numberOfThisDisk=a.readShort(),r.startDisk=a.readShort(),r.totalEntriesThisDisk=a.readShort(),r.totalEntries=a.readShort(),r.centralDirectorySize=a.readUint(),r.centralDirectoryOffset=a.readUint(),r.commentLength=a.readShort(),r.comment=a.readArray(r.commentLength),r}var we=class{constructor(e,r={}){this.ip=0,this.EOCD=null,this.input=e instanceof Uint8Array?e:new Uint8Array(e),this.verify=r.verify??!1,r.password&&(this.password=typeof r.password=="string"?S(r.password):r.password instanceof Uint8Array?r.password:new Uint8Array(r.password))}parseFileHeader(){var e=[],r={};if(!this.fileHeaderList){for(var t=pe(this.input),a=new B(this.input,t.centralDirectoryOffset),i=0;i<t.totalEntries;++i){var s=ve(a);e[i]=s,r[s.filename]=i}if(t.centralDirectorySize<a.p-t.centralDirectoryOffset)throw new Error("invalid file header size");this.EOCD=t,this.fileHeaderList=e,this.filenameToIndex=r}}getFileData(e,r={}){var t=this.input,a=this.fileHeaderList,i;if(a||this.parseFileHeader(),a[e]==null)throw new Error("wrong index");var s=a[e].relativeOffset,h=new B(this.input,s),n=ue(h);s+=n.length;var f=n.compressedSize;if(n.flags&1){var u=r.password??this.password;if(!u)throw new Error("encrypted: please set password");for(var l=L.createKey(u),v=s;v<s+12;++v)L.decode(l,t[v]),console.log(t[v]);console.log(n.crc32),s+=12,f-=12;for(var v=s;v<s+f;++v)t[v]=L.decode(l,t[v])}if(n.compression==8?i=new te(this.input,{index:s,bufferSize:n.plainSize}).decompress():i=this.input.subarray(s,s+f),this.verify){var o=A.create(i);if(n.crc32!==o)throw new Error("Incorrect crc: file=0x"+n.crc32.toString(16)+", data=0x"+o.toString(16))}return i}getFilenames(){var e=[];this.fileHeaderList||this.parseFileHeader();for(var r=this.fileHeaderList,t=0;t<r.length;++t)e[t]=r[t].filename;return e}decompress(e,r={}){this.filenameToIndex||this.parseFileHeader();var t=this.filenameToIndex[e];if(t==null)throw new Error(e+" not found");return this.getFileData(t,r)}setPassword(e){typeof e=="string"?this.password=S(e):this.password=e instanceof Uint8Array?e:new Uint8Array(e)}},ce={Zip:oe,Unzip:we};window.Zlib=ce})();
